(this["webpackJsonpfavourite-cats"]=this["webpackJsonpfavourite-cats"]||[]).push([[0],{26:function(e,t,r){},27:function(e,t,r){},28:function(e,t,r){},31:function(e,t,r){},50:function(e,t,r){},51:function(e,t,r){"use strict";r.r(t);var a=r(2),c=r.n(a),o=r(17),i=r.n(o),n=(r(26),r(27),r(28),r(52)),s=r(53),l=r(54),d=r(1),u=function(e){var t=e.activeFilter,r=e.changeActiveFilter,a=e.showFavorite;e.isFavorite;return Object(d.jsx)("div",{className:"header-wrapper",children:Object(d.jsx)("div",{className:"header-container",children:Object(d.jsxs)("div",{className:"header",children:[Object(d.jsxs)("div",{className:"hot"===t?"header-filter-active":"header-filter",onClick:function(){return r("hot")},children:[Object(d.jsx)(n.d,{className:"hot"===t?"activeFilter":"defaultFilter"}),"Hot"]}),Object(d.jsxs)("div",{className:"new"===t?"header-filter-active":"header-filter",onClick:function(){return r("new")},children:[Object(d.jsx)(s.b,{className:"new"===t?"activeFilter":"defaultFilter"}),"New"]}),Object(d.jsxs)("div",{className:"top"===t?"header-filter-active":"header-filter",onClick:function(){return r("top")},children:[Object(d.jsx)(s.a,{className:"top"===t?"activeFilter":"defaultFilter"}),"Top"]}),Object(d.jsxs)("div",{className:"favorite"===t?"header-filter-active":"header-filter",children:[Object(d.jsx)(l.a,{className:"favorite"===t?"activeFilter":"defaultFilter",onClick:function(){return r("favorite"),void a()}}),"Favorite"]})]})})})},v=r(8),j=r.n(v),f=r(18),b=r(4),m=(r(31),r(19)),h=r.n(m),O=(r(50),r(55)),p=function(e){var t,r=e.ups,c=e.author,o=e.title,i=e.media,s=e.preview,l=e.comments,u=e.saveToDb,v=e.delFromDb,j=e.fromDb,f=Object(a.useState)(!!j),m=Object(b.a)(f,2),h=m[0],p=m[1];return Object(d.jsxs)("div",{className:"card-wrapper",children:[Object(d.jsxs)("div",{className:"card-score",children:[Object(d.jsx)(n.c,{fontSize:"1.5em",color:"#b2b4b6"}),r,Object(d.jsx)(n.b,{fontSize:"1.5em",color:"#b2b4b6"})]}),Object(d.jsxs)("div",{className:"card-content",children:[Object(d.jsx)("div",{className:"card-author",children:Object(d.jsxs)("span",{children:["Posted by ",c]})}),Object(d.jsx)("div",{className:"card-description",children:o}),Object(d.jsx)("div",{className:"card-img",children:i?Object(d.jsx)("video",{preload:"auto",src:null===(t=i.reddit_video)||void 0===t?void 0:t.fallback_url,loop:!0,autoPlay:!0}):Object(d.jsx)("img",{src:null===s||void 0===s?void 0:s.images[0].resolutions[1].url})}),Object(d.jsxs)("div",{className:"card-info",children:[Object(d.jsxs)("div",{className:"card-comments",children:[Object(d.jsx)(O.a,{fontSize:"1.6em",color:"#b2b4b6"}),Object(d.jsxs)("span",{children:[l," Comments"]})]}),Object(d.jsx)("div",{className:h?"card-like-active":"card-like",onClick:function(){if(h)return p(!1),void v({ups:r,author:c,title:o,media:i,preview:s,comments:l,saveToDb:u,delFromDb:v});p(!0),u({ups:r,author:c,title:o,media:i,preview:s,comments:l})},children:Object(d.jsx)(n.a,{className:"likeImg"})})]})]})]})},x=r(20),w=function(){var e=Object(a.useState)([]),t=Object(b.a)(e,2),r=t[0],c=t[1],o=Object(a.useState)([]),i=Object(b.a)(o,2),n=i[0],s=i[1],l=Object(a.useState)(!1),v=Object(b.a)(l,2),m=v[0],O=v[1],w=Object(a.useState)("top"),g=Object(b.a)(w,2),N=g[0],F=g[1],S=Object(a.useState)({after:null}),k=Object(b.a)(S,2),C=k[0],D=k[1],y=Object(a.useState)(""),T=Object(b.a)(y,2),_=T[0],E=T[1];Object(a.useEffect)((function(){var e=window.indexedDB.open("favoritePost",1);e.onerror=function(e){console.log("IndexDb error: ",e.target.errorCode)},e.onupgradeneeded=function(e){e.target.result.createObjectStore("favorites",{autoIncrement:!0})},e.onsuccess=function(e){E(e.target.result)}}));var A=function(e){var t=_.transaction("favorites","readwrite");t.objectStore("favorites").add(e),t.oncomplete=function(e){console.log("Success save")},t.onerror=function(e){console.log("ERROR save",e.target.errorCode)}},I=function(e){if(_){var t=_.transaction(["favorites"],"readwrite").objectStore("favorites").openCursor();t.onsuccess=function(t){var r=t.target.result;if(null!==r){if(console.log("cursor!",r),r.value.title===e.title)r.delete().onsuccess=function(){console.log("delete success")};r.continue()}},t.onerror=function(e){alert("error in cursor request ".concat(e.target.errorCode))}}},R=function(e){var t;return null!==e&&(t="limit=".concat(e.limit,"&raw_json=").concat(e.raw_json),console.log("AFTER",e.after),null!==e.after&&(t+="&after=".concat(e.after))),t},z=function(){var e=Object(f.a)(j.a.mark((function e(){var t,a,o,i,n,s,l,d,u,v,f=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=!(f.length>0&&void 0!==f[0])||f[0],l={limit:10,raw_json:1,after:s?C.after:null},d="https://www.reddit.com/r/cats/".concat(N,".json?&").concat(R(l)),e.next=5,h()(d);case 5:if(e.t1=t=e.sent,e.t0=null!==e.t1,!e.t0){e.next=9;break}e.t0=void 0!==t;case 9:if(!e.t0){e.next=13;break}e.t2=t,e.next=14;break;case 13:e.t2=[];case 14:u=e.t2,v=null===u||void 0===u||null===(a=u.data)||void 0===a||null===(o=a.data)||void 0===o?void 0:o.children.filter((function(e){return"preview"in e.data})),D({after:null===u||void 0===u||null===(i=u.data)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.after}),c(s?r.concat(v):v);case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){"favorite"!==N&&z(!1)}),[N]);return Object(d.jsxs)("div",{className:"mainContainer",children:[Object(d.jsx)(u,{activeFilter:N,changeActiveFilter:function(e){"favorite"!==e&&O(!1),F(e)},showFavorite:function(){O(!0),function(){var e=[];if(_){var t=_.transaction(["favorites"],"readonly").objectStore("favorites").openCursor();t.onsuccess=function(t){var r=t.target.result;console.log("cursor",r),null!=r?(e.push(r.value),r.continue()):s(e)},t.onerror=function(e){alert("error in cursor request ".concat(e.target.errorCode))}}s(e)}()},isFavorite:m}),Object(d.jsx)(x.a,{className:"infinity-scroll",next:z,hasMore:!m,loader:Object(d.jsx)("h2",{children:"Loading..."}),dataLength:r.length,children:m?n.map((function(e){return Object(d.jsx)(p,{ups:e.ups,author:e.author,title:e.title,media:null===e||void 0===e?void 0:e.media,preview:null===e||void 0===e?void 0:e.preview,comments:null===e||void 0===e?void 0:e.comments,saveToDb:A,delFromDb:I,fromDb:!0},e.id)})):r.map((function(e){var t,r,a,c;return Object(d.jsx)(p,{ups:null===(t=e.data)||void 0===t?void 0:t.ups,author:e.data.author,title:e.data.title,media:null===(r=e.data)||void 0===r?void 0:r.media,preview:null===(a=e.data)||void 0===a?void 0:a.preview,comments:null===(c=e.data)||void 0===c?void 0:c.num_comments,saveToDb:A,delFromDb:I,fromDb:!1},e.data.id)}))})]})};var g=function(){return Object(d.jsx)("div",{className:"App",children:Object(d.jsx)(w,{})})};i.a.render(Object(d.jsx)(c.a.StrictMode,{children:Object(d.jsx)(g,{})}),document.getElementById("root"))}},[[51,1,2]]]);
//# sourceMappingURL=main.1ae0ddfb.chunk.js.map